<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF Initialization Test</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
        #status { padding: 10px; border-radius: 5px; margin-bottom: 10px; font-weight: bold; }
        .success { background-color: #e0ffe0; border: 1px solid #008000; color: #008000; }
        .error { background-color: #ffe0e0; border: 1px solid #ff0000; color: #ff0000; }
        #profile { border: 1px solid #ccc; padding: 10px; border-radius: 5px; display: none; }
        img { border-radius: 50%; }
    </style>
</head>
<body>
    <h1>LIFF Initialization Test</h1>
    <p>หน้านี้ใช้เพื่อทดสอบการเชื่อมต่อ LIFF ขั้นพื้นฐาน</p>
    <div id="status">กำลังเริ่มต้น...</div>
    <div id="profile">
        <h2>Profile Information</h2>
        <p><strong>User ID:</strong> <span id="userId"></span></p>
        <p><strong>Display Name:</strong> <span id="displayName"></span></p>
        <img id="pictureUrl" src="" alt="Profile Picture" width="100">
    </div>

    <script>
        // LIFF ID has been set to your app's ID
        const LIFF_ID = "1654435774-E1myB7b4"; 
        
        const statusDiv = document.getElementById('status');
        const profileDiv = document.getElementById('profile');

        async function main() {
            try {
                statusDiv.textContent = `กำลังเชื่อมต่อกับ LIFF ID: ${LIFF_ID}...`;
                await liff.init({ liffId: LIFF_ID });
                
                statusDiv.textContent = 'liff.init() สำเร็จ! กำลังตรวจสอบสถานะ Login...';
                
                if (!liff.isLoggedIn()) {
                    statusDiv.textContent = 'ยังไม่ได้ Login, กำลังสั่งให้ Login...';
                    liff.login();
                    return; // หยุดการทำงานหลังจากสั่ง login
                }

                statusDiv.textContent = 'Login สำเร็จ! กำลังดึงข้อมูลโปรไฟล์...';
                const profile = await liff.getProfile();

                statusDiv.textContent = 'ดึงข้อมูลโปรไฟล์สำเร็จ!';
                statusDiv.className = 'success';

                // แสดงข้อมูล
                profileDiv.style.display = 'block';
                document.getElementById('userId').textContent = profile.userId;
                document.getElementById('displayName').textContent = profile.displayName;
                document.getElementById('pictureUrl').src = profile.pictureUrl;

            } catch (error) {
                console.error("LIFF Initialization failed", error);
                statusDiv.textContent = `เกิดข้อผิดพลาด: ${error.message}`;
                statusDiv.className = 'error';
            }
        }

        // เริ่มการทำงาน
        main();
    </script>
</body>
</html>

